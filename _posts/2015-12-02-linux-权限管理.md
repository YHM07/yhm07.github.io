---
layout: post
title:  "linux学习笔记二--linux权限管理"
keywords: ""
description: ""
category: "linux" 
tags: [linux权限管理]
---


# 4.2 权限及权限管理 2015/11/1
@(linux)[linux权限管理]

<!-- more -->

## 权限管理 

### chown 改变文件属主
 
chown [options] USERNAME file,...
	* -R 修改目录及其内部文件的属主
	* --reference=/path/to/somefile file,...
	
chown [options] USERNAME:GRPNAME file,...

chown [options] USERNAME:GRPNAME file,...

chgrp [options] GRPNAME file,... 
	* -R 
	* --reference=/path/to/somefile file,...

### chmod 修改文件权限

chmod [options] MODE file,...
	* -R 
	* --reference=/path/to/somefile file,...
	
chmod [options] u/g/o/a=MOD file,...
chmod [options] u/g/o=MOD,u/g/o=MOD file,...

### 从用户登录的角度来说SHELL 类型

登陆式SHELL:
	* 正常终端登录
	* su - USERNAME
	* su -l USERNAME 

非登陆式SHELL:
	* su USERNAME 
	* 图形终端下打开命令窗口
	* 自动执行的SHELL脚本

bash配置文件
	* 全局配置
		- /etc/profile, 
		- /etc/profile.d/*.sh, 
		- /etc/bashrc
	* 个人配置
		- ~/.bash_profile, 
		- ~/.bashrc

profile 文件
	* 设定环境变量
	* 运行命令或脚本

bashrc 文件
	* 设定本地变量
	* 定义命令别名

登陆式SHELL如何读取配置文件
	- /etc/profile --> /etc/profile.d/*.sh --> ~/.bash_profile --> ~/.bashrc --> /etc/bashrc

非登陆式SHELL如何读取配置文件
	- ~/.bashrc --> /etc/bashrc --> /etc/profile.d/*.sh

## 管理及IO重定向

### 计算机部件

	* 运算器,控制器: CPU
	* 存储器: RAM
	* 输入输出设备
	* 程序: 指令和数据
	
1. 地址总线：内存寻址
2. 数据总数：传输数据
3. 控制总线：控制指令

### IO重定向

set -C: 禁止对已经存在文件使用覆盖重定向;强制覆盖输出,则使用 >|

set +C: 关闭上述功能

&>: 重定向标准输出或标准错误输出到同一文件


## 练习

1. 统计/usr/bin目录下的文件个数
	ls /usr/bin | wc -l 
2. 取出当前系统上所有用户的shell,要求每种shell只显示一次,并按顺序显示,(统计每种shell出现的次数)
	cat /etc/passwd | cut -d: -f7 | sort -u
	
	(cat /etc/passwd | cut -d: -f7 | awk '{s[$0]++}END{for(i in s) { print i"\t" s[i] | "sort -k2" ;}}')
3. 如何显示/var/log目录下每个文件的内容类型
	file /var/log/*
4. 取出/etc/inittab文件的第6行
	head -n6 /etc/inittab | tail -n1
5. 取出/etc/passwd文件中倒数第9个用户的用户名和shell,显示到屏幕并保存到/tmp/user文件
	tail -n9 /etc/passwd | head -n1 | cut -d: -f1,7 | tee /tmp/user
6. 显示/etc目录下所有以pa开头的文件,并统计个数
	ls /etc/ | grep '^pa'

	ls -d /etc/pa*

7. 不适用文本编辑器,将alias cls="clear" 一行内容添加至用户的.bashrc文件中.
	echo 'alias cls="clear"' >> ~/.bashrc 


## grep及正则表达式

### grep, egrep, fgrep

1. grep 根据搜索模式文本,并将符合模式的行显示出来

 pattern 文本字符或正则表达式的元字符组合而成的匹配条件

 grep [options] pattern [FILE,...]
	* -i ignore case 
	* --color=[WHEN] 
	* -v 反向查找,显示没有被模式匹配的行
	* -o 只显示被模式匹配到的字符串
	* -E 使用扩展的正则表达式(egrep)
	* -A NUM 显示pattern匹配行及其后NUM行
	* -B NUM 显示pattern匹配行及其前NUM行
	* -C NUM 显示pattern匹配行及其前后各NUM行

2. 正则表达式 REGular EXPression, REGEXP
	* 元字符：
		- . 匹配任意单个字符
		- [] 匹配指定范围内的任意单个字符
		- [^] 匹配指定范围外的任意单个字符
		- [:digit:] 数字
		- [:lower:] 小写字母
		- [:upper:] 大写字母
		- [:punct:] 标点符号
		- [:space:] 空白字符
		- [:alpha:] a-zA-Z
		- [:alnum:] a-zA-Z0-9
		
	* 匹配次数(默认贪婪模式) 
		- \* 匹配其前面的字符任意次,包括零次
		- .\* 匹配任意长度的任意字符	
		- \? 匹配其前面的字符一次或零次(可有可无)
		- \{m,n\} 匹配其前面的字符至少m次,至多n次
	* 位置锚定
		- ^ 锚定行首,此字符后的任意内容必须出现在行首
		- $ 锚定行尾,此字符前的任意内容必须出现在行尾
		- ^$ 空白行
		- \< 或 \b 锚定词首,其后面的任意字符必须作为单词首部出现
		- \> 或 \b 锚定词尾,其前面的任意字符必须作为单词尾部出现
	* 分组 \( \) 
		- 后向引用 \n 表示第n个左括号以及对应的右括号的内容

3. 扩展正则表达式 (Extend REGular EXPression)
	- + 匹配其前面的字符至少一次
	- {m,n} 匹配次数
	- () 分组, \1, \2, \3, .., \9
	- | 表示或者
	
 e.g. ifconfig | grep -E "\b([1-9]|[1-9][0-9]|1[0-9][0-9]|2[01][0-9]|22[0-3]\b)(\.\b([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-4])\b){2}\.\b([1-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-4])\b"

 e.g. ifconfig | grep -E "(\<([1-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5]\>)\.){3}(\<[0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5]\>)"
